- Веб приложение - https://surikov.github.io/rockdice/main.html
# Автогенерация музыки

![image](https://github.com/Vokoon/Laba3_Akimov/assets/120046709/5627d2b8-9e8a-40a8-a75c-d5c03a127b5f)


Автоматическое создание музыки по заданным параметрам.
Используется Web Audio API, TypeScript, Android WebView, таблично-волновой синтез и элементарная теория музыки.

---
# Описание работы

![image](https://github.com/Vokoon/Laba3_Akimov/assets/120046709/fe188fb5-a961-4fd9-b764-d228e383bcd2)


В основном окне можно слайдером выбрать прогрессию. Последовательность аккордов определяет настроение мелодии (слева минорные, справа мажорные, посередине джазовые септаккорды).
Круглыми переключателями можно выбрать риффы для стандартных 4-х слоёв мелодии
- Drums - задает ритм
- Bass - гармоническая основа и ритм
- Lead - создаёт мелодический рисунок
- Pad - контрапункт, протяжные ноты показывающие функцию аккорда

По голубой кнопке с игральным кубиком выбираются рандомные значения.

Приложение делает модуляцию выбранных фрагментов под заданные аккорды. Если покрутить переключатели и прослушать несколько мелодий, можно убедиться что при любом сочетании аккордов и инструментов звучание результата получается вполне "человеческое".


## Настройки

По кнопке с шестерёнкой открывается окно настроек.
Можно редактировать громкость по слоям, скорость, менять аккорды, транспонировать:

![image](https://github.com/Vokoon/Laba3_Akimov/assets/120046709/e3729c56-1d0b-462c-9bfd-7ba6218a8ccf)


Для каждого трека можно выбрать рифф из списка:

![image](https://github.com/Vokoon/Laba3_Akimov/assets/120046709/d6e02c92-20c3-4c8e-b5d5-651db9fe8924)


Также можно выбрать аккордовую последовательность:

![image](https://github.com/Vokoon/Laba3_Akimov/assets/120046709/cd9605b8-7d36-4fdb-a7d9-4992bb8772d2)


## История

Возможность отменить прошлое действие и вернуться в предидущее состояние это типовое требование для любых приложений.
По кнопке с иконкой Undo (справа вверху) открывается окно с историей подбора мелодий:

![image](https://github.com/Vokoon/Laba3_Akimov/assets/120046709/ff6df00c-6545-4fda-b371-86d0842a2e77)



# Описание реализации

## Воспроизведение звука

Для воспроизведения звука используется библиотека WebAudioFont:

https://github.com/surikov/webaudiofont

В библиотеке содержатся более 2000 оцифрованных инструментов и основные фильтры для обработки звука:

- 10-полосный эквалайзер для настройки тембра
- эхо для объёмного звучания
- динамический компрессор для выделения голосов

Документация:

https://surikov.github.io/webaudiofont/npm/src/docs/index.html

## Модуляция фрагментов

Для выбранных (или введённых вручную) аккордов в функции extractMode вычисляется тоника и лад, см.

https://github.com/surikov/rockdice/blob/main/ts/code/zvoogharmonizer.ts#L1156

Для воспроизведения музыки в проект добавлено около двухсот риффов с разными инструментами, их можно посмотреть в папке

https://github.com/surikov/rockdice/tree/main/patterns

Каждый паттерн кроме нот также содержит описание лада и тоники.

Выбранные риффы в функции  morphSchedule транспонируются в тонику выбранных аккордов и проводится модуляция в лад аккордовой прогрессии, см.

https://github.com/surikov/rockdice/blob/main/ts/code/zvoogharmonizer.ts#L377

- Транспонирование мелодии это перенос всех нот на равное количество полутонов. По-простому - сделать звук выше или ниже.
- Модуляция мелодии это сдвиг определённых ступеней лада. По-простому - из минора в мажор и т.п.


Результат :https://vk.com/away.php?to=https%3A%2F%2Fmzxbox.ru%2FRockDice%2Fshare.php%3Fseed%3D%257B%2522drumsSeed%2522%253A9%252C%2522bassSeed%2522%253A12%252C%2522leadSeed%2522%253A34%252C%2522padSeed%2522%253A9%252C%2522drumsVolume%2522%253A111%252C%2522bassVolume%2522%253A99%252C%2522leadVolume%2522%253A66%252C%2522padVolume%2522%253A77%252C%2522chords%2522%253A%255B%2522Cm%2522%252C%25222%252F1%2522%252C%2522Ebm%2522%252C%25222%252F1%2522%255D%252C%2522tempo%2522%253A130%252C%2522mode%2522%253A%2522Ionian%2522%252C%2522tone%2522%253A%2522D%2523%2522%252C%2522version%2522%253A%2522v2.89%2522%252C%2522comment%2522%253A%2522%2522%252C%2522ui%2522%253A%2522web%2522%257D&el=snippet
